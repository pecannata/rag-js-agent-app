#!/bin/bash

# Mac Deployment Script for RAG-JS-Agent-App
# Run this script to deploy the production build

echo "ğŸš€ Starting Mac deployment..."

# Stop any existing production server
echo "Stopping existing production server..."
pkill -f "npm start" || true
pkill -f "next-server" || true

# Build the project
echo "Building production version..."
npm run build -- --no-lint

# Start production server in background
echo "Starting production server..."
nohup npm start > production.log 2>&1 &

# Wait a moment for server to start
sleep 3

# Check if server is running
echo "Checking server status..."
STATUS=$(curl -s -o /dev/null -w "%{http_code}" http://localhost:3000)

if [ "$STATUS" = "200" ]; then
    echo "âœ… Production server is running successfully!"
    echo "ğŸ“ URL: http://localhost:3000"
    echo "ğŸ“ Logs: tail -f production.log"
    echo "ğŸ›‘ Stop: pkill -f 'npm start'"
else
    echo "âŒ Server failed to start properly"
    echo "Check production.log for errors"
fi
